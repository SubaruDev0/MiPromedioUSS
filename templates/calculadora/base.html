{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Promedio USS</title>
    <link rel="stylesheet" href="{% static 'css/uss-styles.css' %}">
    <!-- Font Awesome para íconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>

    <!-- Encabezado -->
    <!-- Encabezado -->
    <div class="header">
        {% if user.is_authenticated %}
        <div class="header-left" style="flex: 1;">
            <span style="font-size: 0.95rem; font-weight: 600; color: var(--text-secondary);">Hola, {{ user.username|title }}</span>
        </div>
        <div class="header-center" style="flex: 2; text-align: center;">
            {% if user.perfilusuario and user.perfilusuario.carrera %}
            <div
                style="display: inline-block; padding: 6px 16px; background: linear-gradient(135deg, var(--primary-color), var(--accent-color)); border-radius: var(--radius-pill); box-shadow: var(--shadow-md);">
                <span style="font-size: 0.9rem; font-weight: 700; color: white; letter-spacing: 0.3px;">{{ user.perfilusuario.carrera.nombre }}</span>
            </div>
            {% else %}
            <span style="font-size: 1rem; font-weight: 700; color: var(--primary-color);">Mi Promedio USS</span>
            {% endif %}
        </div>
        <div class="header-icons" style="flex: 1; justify-content: flex-end;">
            <i class="far fa-bell"></i>
            <i class="fas fa-bars"></i>
            {% if user.is_superuser %}
            <a href="{% url 'admin_panel' %}" title="Panel Admin" style="color: var(--primary-color); margin-left: 10px; text-decoration: none;"><i class="fas fa-shield-alt"></i></a>
            {% endif %}
        </div>
        {% else %}
        <div class="header-title">Calculadora de Notas</div>
        <div class="header-icons">
            <i class="far fa-bell"></i>
            <i class="fas fa-bars"></i>
        </div>
        {% endif %}
    </div>

    <!-- Contenido Principal -->
    <div class="content">
        {% if messages %}
        <div style="max-width:800px; margin: 12px auto;">
            {% for message in messages %}
            <div style="padding:8px 12px; border-radius:6px; margin-bottom:8px; background: {% if message.tags == 'success' %}var(--success-light){% elif message.tags == 'error' %}var(--danger-light){% else %} #eef2ff {% endif %}; color: {% if message.tags == 'success' %}var(--success-color){% elif message.tags == 'error' %}var(--danger-color){% else %}var(--text-main){% endif %};">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}
        {% block content %}
        {% endblock %}
    </div>

    <!-- Navegación Inferior -->
    <div class="bottom-nav">
        <a href="{% url 'home' %}" class="nav-item {% if request.resolver_match.url_name == 'home' %}active{% endif %}"
            style="text-decoration: none;">
            <i class="fas fa-calculator nav-icon"></i>
            <span>Calculadora</span>
        </a>

        {% if user.is_authenticated %}
        <a href="{% url 'dashboard' %}"
            class="nav-item {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
            style="text-decoration: none;">
            <i class="fas fa-book nav-icon"></i>
            <span>Mis Notas</span>
        </a>
        {% endif %}

        <!-- QR Button Removed as requested -->

        {% if user.is_authenticated %}
        <form action="{% url 'logout' %}" method="post" id="logout-form" style="display: none;">{% csrf_token %}</form>
        <div class="nav-item" onclick="document.getElementById('logout-form').submit()">
            <i class="fas fa-sign-out-alt nav-icon"></i>
            <span>Salir</span>
        </div>
        {% else %}
        <a href="{% url 'login' %}"
            class="nav-item {% if request.resolver_match.url_name == 'login' %}active{% endif %}"
            style="text-decoration: none;">
            <i class="fas fa-user nav-icon"></i>
            <span>Mi Cuenta</span>
        </a>
        {% endif %}
    </div>

    <script src="{% static 'js/calculadora.js' %}"></script>
</body>

</html>